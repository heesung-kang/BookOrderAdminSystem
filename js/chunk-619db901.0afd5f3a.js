(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-619db901"],{"6f13":function(t,e,s){},"6f4c":function(t,e,s){"use strict";s.r(e);s("14d9");var o=s("2f62"),a=s("e31c"),i=s("e71f"),n=s("f3e4"),c={name:"PublisherList",components:{TableSkeleton:s("78c6").a},data:()=>({origin:[],shops:[],keyword:"",sid:"",sids:[],oldRate:[]}),computed:{...Object(o.b)("common",["skeletonLoading"])},async created(){const t=Object(n.b)("userInfo");this.sid=t.info.sid,this.sids=[],this.$store.commit("common/setSkeleton",!0);const e=Object(i.i)(Object(i.b)(a.b,"booksData"),Object(i.m)("sid","==",this.sid));(await Object(i.f)(e)).forEach(t=>{this.sids.push(t.id)}),await this.load()},methods:{async load(){this.origin=[],this.shops=[],this.loadRate=[];try{this.$store.commit("common/setSkeleton",!0);const t=Object(i.i)(Object(i.b)(a.b,"shopInfo"));(await Object(i.f)(t)).forEach(t=>{this.origin.push({uid:t.id,data:t.data()}),this.shops.push({uid:t.id,data:t.data()})}),this.$store.commit("common/setSkeleton",!1)}catch(t){console.log(t)}},async shopRateSave(){try{this.$store.commit("common/setLoading",!0);const t=Object(i.n)(a.b);this.shops.forEach(e=>{const s=e.data.shopRate.filter(t=>t.sid!==this.sid),o=Object(i.d)(a.b,"shopInfo",e.uid);e.data.shopRate.forEach(a=>{a.sid===this.sid&&t.set(o,{...e.data,shopRate:[...s,{sid:this.sid,rate:a.rate}]})})}),await t.commit(),await this.load(),alert("저장되었습니다."),this.$store.commit("common/setLoading",!1)}catch(t){this.$store.commit("common/setLoading",!1),console.log(t)}},search(){if(""!==this.keyword){const t=this.origin.filter(t=>{if(t.data.shop.includes(this.keyword))return t});this.shops=t}else this.shops=this.origin}}},r=(s("d0d4"),s("2877")),d=Object(r.a)(c,(function(){var t=this,e=t._self._c;return e("section",[e("h2",{staticClass:"sub-title"},[t._v("서점별 공급률 설정")]),e("section",{staticClass:"sub-container"},[e("section",{staticClass:"search"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text"},domProps:{value:t.keyword},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search.apply(null,arguments)},input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),e("button",{on:{click:t.search}},[t._v("검색")])]),t.skeletonLoading?e("TableSkeleton"):e("table",[e("thead",[e("tr",[e("th",[t._v("서점명")]),e("th",[t._v("이메일")]),e("th",[t._v("서점 공급률")])])]),e("tbody",t._l(t.shops,(function(s,o){return e("tr",{key:o},[e("td",[t._v(t._s(s.data.shop))]),e("td",[t._v(t._s(s.data.email))]),e("td",t._l(s.data.shopRate,(function(s,o){return e("span",{key:o},[s.sid===t.sid?e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:s.rate,expression:"rate.rate"}],attrs:{type:"number"},domProps:{value:s.rate},on:{input:function(e){e.target.composing||t.$set(s,"rate",e.target.value)}}})]):t._e()])})),0)])})),0),0===t.shops.length?e("tfoot",[e("tr",[e("td",{attrs:{colspan:"3"}},[t._v("서점 리스트가 없습니다.")])])]):t._e()]),e("div",{staticClass:"save mt20"},[e("button",{staticClass:"primary",on:{click:function(e){return t.shopRateSave()}}},[t._v("저장")])])],1)])}),[],!1,null,"401709df",null);e.default=d.exports},"78c6":function(t,e,s){"use strict";var o=s("3129"),a={name:"TableSkeleton"},i=s("2877"),n=Object(i.a)(a,(function(){return(0,this._self._c)(o.a,{attrs:{type:"table-thead, table-tbody",types:{"table-tbody":"table-row-divider@3","table-row":"table-cell@3","table-thead":"heading@3"}}})}),[],!1,null,"1c06d3ce",null);e.a=n.exports},d0d4:function(t,e,s){"use strict";s("6f13")}}]);