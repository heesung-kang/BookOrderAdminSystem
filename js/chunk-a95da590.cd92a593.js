(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a95da590"],{"0021":function(t,e,s){"use strict";s("927e")},4809:function(t,e,s){},"4b70":function(t,e,s){"use strict";s("914f")},5245:function(t,e,s){"use strict";s.r(e);s("14d9");var a=s("2f62"),i=s("68e0"),o=s("490a"),l=s("e71f"),d=s("e31c"),c={name:"Order",components:{modalWrap:s("7402").a},props:["books"],data:()=>({memo:""}),computed:{...Object(a.b)("common",["loading"])},methods:{close(){this.$emit("close")},async save(){try{this.$store.commit("common/setLoading",!0);const t=Object(l.n)(),e=Object(l.s)(d.b);await this.books.forEach(s=>{const a=Object(l.d)(d.b,"orderRequest",s.id);e.update(a,{publisher_reply_status:s.data.publisher_reply_status,reply_count:parseInt(s.data.reply_count),shop_order_status:1,reply_time:t,reply_time_id:this.$date().format("YYYYMMDDHHmmss"),memo:this.memo})}),await e.commit(),this.$emit("close"),this.$attrs.update()}catch(t){console.log(t)}this.$store.commit("common/setLoading",!1)}}},r=(s("c3ec"),s("2877")),n=Object(r.a)(c,(function(){var t=this,e=t._self._c;return e("modalWrap",{on:{close:t.close}},[e("template",{slot:"head"},[e("h2",[t._v("메모")])]),e("template",{slot:"body"},[e("div",{staticClass:"v-application"},[t.loading?e(o.a,{staticClass:"spinner",attrs:{size:70,width:7,color:"amber",indeterminate:""}}):t._e()],1),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.memo,expression:"memo"}],attrs:{placeholder:"남기실 메모가 있으면 적어주세요"},domProps:{value:t.memo},on:{input:function(e){e.target.composing||(t.memo=e.target.value)}}}),e("div",{staticClass:"btn-wrap"},[e("button",{staticClass:"primary",on:{click:t.save}},[t._v("보내기")])])])],2)}),[],!1,null,"991b81e0",null).exports,u=s("b974"),m={props:["dafaultValue","index"],data:()=>({select:0,itemList:[{item:"정상",value:0},{item:"품절",value:1},{item:"절판",value:2},{item:"재고부족",value:3}]}),watch:{select(t){this.$emit("select",{value:t,index:this.index})}},mounted(){this.select=this.dafaultValue}},h=(s("4b70"),Object(r.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"selects"},[e(u.a,{attrs:{dense:"",items:t.itemList,"item-text":"item","item-value":"value",outlined:""},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}})],1)}),[],!1,null,"591e3edd",null).exports),p=s("691b"),_=s("1f0b"),b=s("78dc"),v={components:{SelectsReply:h,BookListSkeleton:p.a,BookListMobileSkeleton:_.a,Toast:b.a},props:["id","orderTimeId","uid"],data:()=>({selected:[],books:[],error:0,message:"",status:!1}),computed:{...Object(a.b)("common",["windowWidth","mobile","skeletonLoading"]),bookCount(){let t=0;return this.books.forEach(e=>t+=Number(e.data.reply_count)),t},totalPrice(){let t=0;return this.books.forEach(e=>{t+=e.data.price*Number(e.data.supply_rate)*e.data.reply_count/100}),t}},created(){this.load()},mounted(){window.onresize=()=>{this.setSize()}},methods:{async load(){try{this.books=[],this.$store.commit("common/setSkeleton",!0);const t=Object(l.m)(Object(l.b)(d.b,"orderRequest"),Object(l.r)("uid","==",this.uid),Object(l.r)("sid","==",Number(this.id)),Object(l.r)("order_time_id","==",this.orderTimeId)),e=await Object(l.h)(t);await e.forEach(t=>{this.books.push({id:t.id,data:t.data()})}),setTimeout(()=>{this.setSize()},500)}catch(t){console.log(t)}this.$store.commit("common/setSkeleton",!1)},showModal(){this.error=0,this.books.forEach(t=>{t.data.count<t.data.reply_count&&(this.error+=1)}),0===this.error?this.mobile?this.$modal.show(n,{books:this.books,update:this.load},Object(i.a)("ModalMemo","95%","auto",!1)):this.$modal.show(n,{books:this.books,update:this.load},Object(i.a)("ModalMemo","500px","auto",!1)):(this.status=!this.status,this.message="공급이 주문보다 많습니다.")},changeStatus(t){switch(this.books[t.index].data.publisher_reply_status=t.value,t.value){case 0:this.books[t.index].data.reply_count=this.books[t.index].data.count;break;case 1:case 2:this.books[t.index].data.reply_count=0}},setSize(){this.mobile?(this.listWidth=document.querySelector(".body").clientWidth,this.titleMaxWidth=this.listWidth,setTimeout(()=>{document.querySelectorAll(".book-name").forEach(t=>{t.style.maxWidth=this.titleMaxWidth+"px"})},500)):(this.listWidth=document.querySelector(".body").clientWidth,this.titleMaxWidth=this.listWidth-630,setTimeout(()=>{document.querySelectorAll(".book-name").forEach(t=>{t.style.maxWidth=this.titleMaxWidth+"px"})},500))}}},f=(s("0021"),{components:{OrderResultList:Object(r.a)(v,(function(){var t=this,e=t._self._c;return e("section",[!t.mobile&&t.skeletonLoading?e("BookListSkeleton"):t._e(),t.mobile&&t.skeletonLoading?e("BookListMobileSkeleton"):t._e(),t.mobile||t.skeletonLoading?t._e():e("section",{staticClass:"header d-flex"},[e("div",[t._v("품목정보")]),e("div",[t._v("ISBN")]),t._m(0),e("div",[t._v("공급가")]),e("div",[t._v("주문")]),e("div",[t._v("공급")]),e("div",[t._v("회신")])]),e("ul",{staticClass:"body"},t._l(t.books,(function(s,a){var i;return e("li",{key:a,staticClass:"d-flex align-center",class:{none:s.data.shop_order_status>1&&!1===s.data.order_check}},[e("div",{staticClass:"d-flex align-center info-wrap"},[e("div",{staticClass:"book-info"},[e("h3",{staticClass:"book-name"},[t._v(t._s(s.data.subject))]),e("div",{staticClass:"author"},[t._v(t._s(s.data.author))])])]),e("div",{staticClass:"isbn"},[t._v(t._s(s.data.isbn))]),e("div",{staticClass:"d-flex price-info"},[e("div",{staticClass:"normal-price"},[t.mobile?e("span",[t._v("정가")]):t._e(),t._v(" "+t._s(null===(i=s.data.price)||void 0===i?void 0:i.toLocaleString())+"원")]),e("div",[t.mobile?e("span",[t._v("공급률")]):t._e(),t._v(" "+t._s(s.data.supply_rate)+"%")])]),e("div",{staticClass:"final-price"},[t.mobile?e("span",[t._v("공급가")]):t._e(),t._v(" "+t._s((s.data.price*s.data.supply_rate/100).toLocaleString())+"원")]),e("div",{staticClass:"count"},[t.mobile?e("span",[t._v("주문")]):t._e(),t._v(" "+t._s(s.data.count))]),e("div",{staticClass:"count"},[t.mobile?e("span",[t._v("공급")]):t._e(),0===s.data.shop_order_status?e("input",{directives:[{name:"model",rawName:"v-model",value:s.data.reply_count,expression:"book.data.reply_count"}],staticClass:"basic reply-count",attrs:{type:"number",disabled:3!==s.data.publisher_reply_status},domProps:{value:s.data.reply_count},on:{input:function(e){e.target.composing||t.$set(s.data,"reply_count",e.target.value)}}}):e("span",{class:{warning:s.data.count>s.data.reply_count}},[t._v(t._s(s.data.reply_count))])]),e("div",{staticClass:"btn-wrap"},[0===s.data.shop_order_status?e("SelectsReply",{attrs:{index:a,dafaultValue:s.data.publisher_reply_status},on:{select:t.changeStatus}}):e("div",[t._v("\n          "+t._s(0===s.data.publisher_reply_status?"정상":1===s.data.publisher_reply_status?"품절":2===s.data.publisher_reply_status?"절판":"재고부족")+"\n        ")])],1)])})),0),t.skeletonLoading?t._e():e("section",{staticClass:"total-wrap mt24"},[e("div",[e("span",{staticClass:"total-prod"},[t._v("총 "+t._s(t.bookCount)+"권")]),e("span",{staticClass:"total"},[t._v("합계 "+t._s(t.totalPrice.toLocaleString())+"원")])]),e("div",{staticClass:"d-flex"},[0!==t.books[0].data.shop_order_status?e("span",[t._v("회신완료")]):e("button",{staticClass:"primary",attrs:{disabled:0!==t.books[0].data.shop_order_status},on:{click:t.showModal}},[t._v("회신")])])]),e("Toast",{attrs:{status:t.status,message:t.message}})],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"d-flex"},[t("div",[this._v("정가")]),t("div",[this._v("공급률")])])}],!1,null,"0bd3821e",null).exports},data(){return{id:this.$route.params.id,date:this.$route.params.date,shopName:this.$route.params.shopName,orderTimeId:this.$route.params.orderTimeId,uid:this.$route.params.uid}}}),k=(s("7db6"),Object(r.a)(f,(function(){var t=this,e=t._self._c;return e("section",[e("h2",{staticClass:"sub-title"},[t._v("주문 내역 확인")]),e("section",{staticClass:"sub-container"},[e("article",{staticClass:"order-info d-flex justify-space-between"},[e("div",[t._v("\n        서점명: "),e("strong",[t._v(t._s(t.shopName))])]),e("div",[t._v(t._s(t.date))])]),e("OrderResultList",{attrs:{id:t.id,orderTimeId:t.orderTimeId,uid:t.uid}})],1)])}),[],!1,null,"81c645b2",null));e.default=k.exports},"68e0":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));const a=function(t,e,s,a){return{name:t,width:e,height:s,resizable:a,clickToClose:!0,draggable:".popup-title",scrollable:!0}}},7402:function(t,e,s){"use strict";var a=s("132d"),i={methods:{close(){this.$emit("close")}}},o=(s("cc0a"),s("2877")),l=Object(o.a)(i,(function(){var t=this._self._c;return t("div",{staticClass:"modal-wrap"},[t("div",{staticClass:"close",on:{click:this.close}},[t(a.a,[this._v("mdi-window-close")])],1),this._t("head"),t("div",{staticClass:"line"}),t("div",{staticClass:"body"},[this._t("body")],2),this._t("footer")],2)}),[],!1,null,"1c84da6b",null);e.a=l.exports},"7db6":function(t,e,s){"use strict";s("d9bc")},8191:function(t,e,s){},"914f":function(t,e,s){},"927e":function(t,e,s){},c3ec:function(t,e,s){"use strict";s("8191")},cc0a:function(t,e,s){"use strict";s("4809")},d9bc:function(t,e,s){}}]);