(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3061de9c"],{"0a80":function(t,s,a){"use strict";a("f630")},"1a22":function(t,s,a){t.exports=a.p+"img/toast_check.8494ca51.svg"},3284:function(t,s,a){"use strict";a("5a51")},4809:function(t,s,a){},4985:function(t,s,a){},"5a51":function(t,s,a){},"68e0":function(t,s,a){"use strict";a.d(s,"a",(function(){return e}));const e=function(t,s,a,e){return{name:t,width:s,height:a,resizable:e,clickToClose:!0,draggable:".popup-title",scrollable:!0}}},"6f4c":function(t,s,a){"use strict";a.r(s);a("14d9");var e=a("2f62"),i=a("e31c"),o=a("e71f"),n=a("f3e4"),c=a("78c6"),r=a("490a"),d={name:"Order",components:{modalWrap:a("7402").a},props:["id","origin"],data:()=>({memo:"",booksList:[],sid:""}),computed:{...Object(e.b)("common",["loading"])},async created(){const t=Object(n.b)("userInfo");this.sid=t.info.sid},async mounted(){this.$store.commit("common/setLoading",!0),this.booksList=[];const t=Object(o.m)(Object(o.b)(i.b,"booksData"),Object(o.r)("sid","==",this.sid));(await Object(o.h)(t)).forEach(t=>{this.booksList.push({id:this.id,data:t.data(),rate:""})});const s=[];this.origin.forEach(t=>{t.uid===this.id&&t.data.bookRate.forEach(t=>{s.push(t.data)})}),this.booksList.forEach(t=>{s.forEach(s=>{s.isbn===t.data.isbn&&(t.rate=s.rate)})}),this.$store.commit("common/setLoading",!1)},methods:{close(){this.$emit("close")},async booksRateSave(t){this.origin.forEach(s=>{s.uid===t&&(this.oldRate=s.data.bookRate)});const s=[];this.booksList.forEach(a=>{s.push({uid:t,data:{isbn:a.data.isbn,rate:a.rate}})});const a=this.oldRate.filter(t=>{s.forEach(s=>{if(t.data.isbn!==s.data.isbn)return t})}),e=s.concat(a);this.$store.commit("common/setLoading",!0);try{await Object(o.q)(Object(o.d)(i.b,"shopInfo",t),{bookRate:e}),this.$store.commit("common/setLoading",!1),this.$attrs.update(),this.close()}catch(t){console.log(t),this.$store.commit("common/setLoading",!1)}}}},l=(a("0a80"),a("2877")),h=Object(l.a)(d,(function(){var t=this,s=t._self._c;return s("modalWrap",{on:{close:t.close}},[s("template",{slot:"head"},[s("h2",[t._v("서적별 공급률 설정")])]),s("template",{slot:"body"},[s("div",{staticClass:"v-application"},[t.loading?s(r.a,{staticClass:"spinner",attrs:{size:70,width:7,color:"amber",indeterminate:""}}):t._e()],1),s("div",{staticClass:"overflow"},[s("ul",t._l(t.booksList,(function(a){return s("li",{key:a.data.isbn,staticClass:"d-flex book-list"},[s("div",{staticClass:"wrap"},[s("span",{staticClass:"mr10 isbn"},[t._v(t._s(a.data.isbn))]),s("span",{staticClass:"mr10 subject"},[t._v(t._s(a.data.subject))]),s("span",{staticClass:"init"},[s("input",{directives:[{name:"model",rawName:"v-model",value:a.rate,expression:"book.rate"}],attrs:{type:"number"},domProps:{value:a.rate},on:{input:function(s){s.target.composing||t.$set(a,"rate",s.target.value)}}})])])])})),0)]),s("div",{staticClass:"btn-save"},[s("button",{staticClass:"primary",on:{click:function(s){return t.booksRateSave(t.id)}}},[t._v("서적별 공급률 저장")])])])],2)}),[],!1,null,"a37fe750",null).exports,u=a("68e0"),m=a("78dc"),b={name:"PublisherList",components:{TableSkeleton:c.a,Toast:m.a},data:()=>({origin:[],shops:[],keyword:"",sid:"",booksList:[],oldRate:[],message:"",status:!1}),computed:{...Object(e.b)("common",["skeletonLoading","mobile"])},async created(){const t=Object(n.b)("userInfo");this.sid=t.info.sid,await this.load()},methods:{async load(){this.origin=[],this.shops=[];try{this.$store.commit("common/setSkeleton",!0);const t=Object(o.m)(Object(o.b)(i.b,"shopInfo"));(await Object(o.h)(t)).forEach(t=>{this.origin.push({uid:t.id,data:t.data()}),this.shops.push({uid:t.id,data:t.data()})}),this.$store.commit("common/setSkeleton",!1)}catch(t){console.log(t)}},booksRateModal(t){console.log(this.mobile),this.mobile?this.$modal.show(h,{id:t,origin:this.origin,update:this.load},Object(u.a)("ModalBookRate","95%","auto",!1)):this.$modal.show(h,{id:t,origin:this.origin,update:this.load},Object(u.a)("ModalBookRate","800px","auto",!1))},async shopRateSave(){try{this.$store.commit("common/setLoading",!0);const t=Object(o.s)(i.b);this.shops.forEach(s=>{const a=s.data.shopRate.filter(t=>t.sid!==this.sid),e=Object(o.d)(i.b,"shopInfo",s.uid);s.data.shopRate.forEach(i=>{i.sid===this.sid&&t.set(e,{...s.data,shopRate:[...a,{sid:this.sid,rate:i.rate}]})})}),await t.commit(),await this.load(),this.status=!this.status,this.message="저장되었습니다",this.$store.commit("common/setLoading",!1)}catch(t){this.$store.commit("common/setLoading",!1),console.log(t)}},search(){if(""!==this.keyword){const t=this.origin.filter(t=>{if(t.data.shop.includes(this.keyword))return t});this.shops=t}else this.shops=this.origin}}},p=(a("72340"),Object(l.a)(b,(function(){var t=this,s=t._self._c;return s("section",[s("h2",{staticClass:"sub-title"},[t._v("서점별 공급률 설정")]),s("section",{staticClass:"sub-container"},[s("section",{staticClass:"search"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text"},domProps:{value:t.keyword},on:{keypress:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.search.apply(null,arguments)},input:function(s){s.target.composing||(t.keyword=s.target.value)}}}),s("button",{on:{click:t.search}},[t._v("검색")])]),t.skeletonLoading?s("TableSkeleton"):s("table",[s("thead",[s("tr",[s("th",[t._v("서점명")]),s("th",[t._v("이메일")]),s("th",[t._v("서점 공급률")]),s("th")])]),t._l(t.shops,(function(a,e){return s("tbody",{key:e},[s("tr",[s("td",[t._v(t._s(a.data.shop))]),s("td",[t._v(t._s(a.data.email))]),s("td",t._l(a.data.shopRate,(function(a,e){return s("span",{key:e},[a.sid===t.sid?s("span",[s("input",{directives:[{name:"model",rawName:"v-model",value:a.rate,expression:"rate.rate"}],attrs:{type:"number"},domProps:{value:a.rate},on:{input:function(s){s.target.composing||t.$set(a,"rate",s.target.value)}}})]):t._e()])})),0),s("td",[s("button",{staticClass:"each",on:{click:function(s){return t.booksRateModal(a.uid)}}},[t._v("서적별 설정")])])])])})),0===t.shops.length?s("tfoot",[s("tr",[s("td",{attrs:{colspan:"4"}},[t._v("서점 리스트가 없습니다.")])])]):t._e()],2),s("div",{staticClass:"save mt20"},[s("button",{staticClass:"primary",on:{click:function(s){return t.shopRateSave()}}},[t._v("저장")])])],1),s("Toast",{attrs:{status:t.status,message:t.message}})],1)}),[],!1,null,"787abfaa",null));s.default=p.exports},"704c":function(t,s,a){t.exports=a.p+"img/cart_xs.3d6bd69d.svg"},72340:function(t,s,a){"use strict";a("4985")},7402:function(t,s,a){"use strict";var e=a("132d"),i={methods:{close(){this.$emit("close")}}},o=(a("cc0a"),a("2877")),n=Object(o.a)(i,(function(){var t=this._self._c;return t("div",{staticClass:"modal-wrap"},[t("div",{staticClass:"close",on:{click:this.close}},[t(e.a,[this._v("mdi-window-close")])],1),this._t("head"),t("div",{staticClass:"line"}),t("div",{staticClass:"body"},[this._t("body")],2),this._t("footer")],2)}),[],!1,null,"1c84da6b",null);s.a=n.exports},"78c6":function(t,s,a){"use strict";var e=a("3129"),i={name:"TableSkeleton"},o=a("2877"),n=Object(o.a)(i,(function(){return(0,this._self._c)(e.a,{attrs:{type:"table-thead, table-tbody",types:{"table-tbody":"table-row-divider@3","table-row":"table-cell@3","table-thead":"heading@3"}}})}),[],!1,null,"1c06d3ce",null);s.a=n.exports},"78dc":function(t,s,a){"use strict";var e=[function(){var t=this._self._c;return t("div",{staticClass:"mr24"},[t("img",{attrs:{src:a("1a22"),alt:""}})])}],i={name:"Toast",props:["status","message","withBtn"],data:()=>({isActive:!1,wrap:"toastWrap"}),watch:{status(){this.handleVisible()}},methods:{handleVisible(){this.isActive=!0,setTimeout(()=>{this.isActive=!1},2e3)}}},o=(a("3284"),a("2877")),n=Object(o.a)(i,(function(){var t=this._self._c;return t("section",{class:[{active:this.isActive},this.wrap]},[t("div",{staticClass:"wrapper"},[t("div",{staticClass:"d-flex message-wrap"},[this._m(0),t("div",{staticClass:"message",domProps:{innerHTML:this._s(this.message)}})]),this.withBtn?t("div",{staticClass:"mt10 right"},[t("router-link",{staticClass:"btn",attrs:{to:"/Cart"}},[t("span",[t("img",{attrs:{src:a("704c"),alt:""}})]),t("span",{staticClass:"ml5"},[this._v("바로가기")])])],1):this._e()])])}),e,!1,null,"19bb7941",null);s.a=n.exports},cc0a:function(t,s,a){"use strict";a("4809")},f630:function(t,s,a){}}]);